SET ECHO ON;
DROP TABLE ANIMAL CASCADE CONSTRAINTS;
DROP TABLE RATION CASCADE CONSTRAINTS;
DROP TABLE FOOD CASCADE CONSTRAINTS;
DROP TABLE CAGE CASCADE CONSTRAINTS;

CREATE TABLE CAGE (
   CLOC     VARCHAR2(5)  PRIMARY KEY,
   CTYPE    VARCHAR2(10) CHECK (CTYPE IN ('BARRED','CORRAL','MOATED','TERRARIUM')),
   CSIZE    VARCHAR2(8)  CHECK (CSIZE IN ('SMALL','MEDIUM','LARGE')));

CREATE TABLE FOOD  (
   FDESC    VARCHAR2(11)  PRIMARY KEY,
   FINV     NUMBER(6,2),
   FUNITS   VARCHAR2(10));

CREATE TABLE ANIMAL  (
   ANAME    VARCHAR2(10),
   ASPECIES VARCHAR2(10),
   AGENDER  CHAR(1)   CHECK (AGENDER IN ('M','F')),
   CLOC     VARCHAR2(5)  REFERENCES CAGE,
   PRIMARY KEY(ANAME,ASPECIES));

CREATE TABLE RATION (
   ANAME      VARCHAR2(10),
   ASPECIES   VARCHAR2(10),
   FDESC      VARCHAR2(10),
   RHOWMUCH   NUMBER(5,1),
   RHOWOFTEN  INTEGER,
   PRIMARY KEY (ANAME, ASPECIES, FDESC),
   FOREIGN KEY (ANAME, ASPECIES) REFERENCES ANIMAL,
   FOREIGN KEY (FDESC) REFERENCES FOOD);

INSERT INTO CAGE VALUES ('B2.1','BARRED','SMALL');
INSERT INTO CAGE VALUES ('B2.2','BARRED','SMALL');
INSERT INTO CAGE VALUES ('B2.3','BARRED','SMALL');
INSERT INTO CAGE VALUES ('A3.1','BARRED','MEDIUM');
INSERT INTO CAGE VALUES ('A3.2','BARRED','MEDIUM');
INSERT INTO CAGE VALUES ('C1.1','CORRAL','LARGE');
INSERT INTO CAGE VALUES ('B4.1','MOATED','MEDIUM');
INSERT INTO CAGE VALUES ('A2.1','MOATED','LARGE');
INSERT INTO CAGE VALUES ('C3.1','TERRARIUM','MEDIUM');

INSERT INTO FOOD VALUES ('MEAT',100,'LBS.');
INSERT INTO FOOD VALUES ('HAY',50,'BALES');
INSERT INTO FOOD VALUES ('GRAIN',75,'BUSHELS');
INSERT INTO FOOD VALUES ('FRUIT',60,'LBS.');
INSERT INTO FOOD VALUES ('VEGETABLES',35,'LBS.');
INSERT INTO FOOD VALUES ('MICE',24,NULL);
INSERT INTO FOOD VALUES ('WORMS',20,NULL);

INSERT INTO ANIMAL VALUES ('LEO','LION','M','B2.1');
INSERT INTO ANIMAL VALUES ('MEO','LION','F','B2.2'); 
INSERT INTO ANIMAL VALUES ('ZEO','LION',NULL,'B2.2'); 
INSERT INTO ANIMAL VALUES ('BLACKIE','PANTHER','M','B2.3'); 
INSERT INTO ANIMAL VALUES ('MOLLY','PANTHER','F','B2.3'); 
INSERT INTO ANIMAL VALUES ('JEFFREY','GIRAFFE','M','C1.1'); 
INSERT INTO ANIMAL VALUES ('MOLLY','DONKEY','F','C1.1'); 
INSERT INTO ANIMAL VALUES ('CONRAD','CAMEL','M','C1.1'); 
INSERT INTO ANIMAL VALUES ('FANNY','ELEPHANT','F','A2.1'); 
INSERT INTO ANIMAL VALUES ('MORRIS','ELEPHANT',NULL,'A2.1'); 
INSERT INTO ANIMAL VALUES ('CHUBBLES','HIPPO','F','B4.1'); 
INSERT INTO ANIMAL VALUES ('SUZY','MONKEY','F','A3.1'); 
INSERT INTO ANIMAL VALUES ('SALLY','MONKEY','F','A3.1'); 
INSERT INTO ANIMAL VALUES ('SAM','MONKEY','M','A3.1'); 
INSERT INTO ANIMAL VALUES ('BOSS','APE','M','A3.2'); 

INSERT INTO RATION VALUES ('LEO','LION','MEAT',10,4);
INSERT INTO RATION VALUES ('MEO','LION','MEAT',7,4);
INSERT INTO RATION VALUES ('ZEO','LION','MEAT',2,7);
INSERT INTO RATION VALUES ('ZEO','LION','FRUIT',0.5,7);
INSERT INTO RATION VALUES ('BLACKIE','PANTHER','MEAT',4,4);
INSERT INTO RATION VALUES ('MOLLY','PANTHER','MEAT',4,4);
INSERT INTO RATION VALUES ('JEFFREY','GIRAFFE','HAY',2,7);
INSERT INTO RATION VALUES ('JEFFREY','GIRAFFE','GRAIN',0.2,7);
INSERT INTO RATION VALUES ('JEFFREY','GIRAFFE','FRUIT',2,7);
INSERT INTO RATION VALUES ('MOLLY','DONKEY','HAY',1,7);
INSERT INTO RATION VALUES ('MOLLY','DONKEY','GRAIN',0.1,7);
INSERT INTO RATION VALUES ('MOLLY','DONKEY','FRUIT',2,7);
INSERT INTO RATION VALUES ('CONRAD','CAMEL','GRAIN',0.2,7);
INSERT INTO RATION VALUES ('CONRAD','CAMEL','FRUIT',4,7);
INSERT INTO RATION VALUES ('FANNY','ELEPHANT','HAY',4,7);
INSERT INTO RATION VALUES ('FANNY','ELEPHANT','FRUIT',4,7);
INSERT INTO RATION VALUES ('MORRIS','ELEPHANT','HAY',1,7);
INSERT INTO RATION VALUES ('MORRIS','ELEPHANT','FRUIT',2,7);
INSERT INTO RATION VALUES ('CHUBBLES','HIPPO','MICE',5,1);
INSERT INTO RATION VALUES ('CHUBBLES','HIPPO','FRUIT',10,7);
INSERT INTO RATION VALUES ('SUZY','MONKEY','FRUIT',2,7);
INSERT INTO RATION VALUES ('SUZY','MONKEY','VEGETABLES',1,7);
INSERT INTO RATION VALUES ('SALLY','MONKEY','FRUIT',2,7);
INSERT INTO RATION VALUES ('SALLY','MONKEY','VEGETABLES',1,7);
INSERT INTO RATION VALUES ('SAM','MONKEY','FRUIT',3,7);
INSERT INTO RATION VALUES ('SAM','MONKEY','VEGETABLES',1,7);
INSERT INTO RATION VALUES ('BOSS','APE','FRUIT',6,7);
INSERT INTO RATION VALUES ('BOSS','APE','VEGETABLES',3,7);
INSERT INTO RATION VALUES ('BOSS','APE','GRAIN',0.1,7);

SELECT ANIMAL.ANAME, CAGE.CLOC
FROM ANIMAL, CAGE
WHERE ANIMAL.CLOC = CAGE.CLOC;

SELECT ANIMAL.ANAME
FROM ANIMAL, CAGE
WHERE CAGE.CTYPE = 'BARRED' AND ANIMAL.CLOC = CAGE.CLOC
ORDER BY ANIMAL.ASPECIES, ANIMAL.ANAME;

SELECT RATION.FDESC
FROM RATION, ANIMAL, CAGE
WHERE RATION.ANAME = ANIMAL.ANAME AND RATION.ASPECIES = ANIMAL.ASPECIES AND ANIMAL.CLOC = CAGE.CLOC AND CAGE.CSIZE = 'MEDIUM'
ORDER BY RATION.FDESC;

SELECT DISTINCT FOOD.FDESC, FOOD.FINV
FROM FOOD, RATION
WHERE FOOD.FDESC = RATION.FDESC AND RATION.ASPECIES = 'LION'
ORDER BY FOOD.FINV DESC;

SELECT DISTINCT CAGE.CLOC
FROM ANIMAL, CAGE
WHERE ANIMAL.ANAME IN (SELECT DISTINCT RATION.ANAME FROM RATION WHERE RATION.FDESC = 'FRUIT') AND ANIMAL.ASPECIES IN (SELECT DISTINCT RATION.ASPECIES FROM RATION WHERE RATION.FDESC = 'FRUIT') AND ANIMAL.CLOC = CAGE.CLOC
ORDER BY CAGE.CLOC;

SELECT DISTINCT RATION.ANAME, RATION.ASPECIES
FROM RATION
WHERE RATION.FDESC IN (SELECT RATION.FDESC FROM RATION WHERE RATION.ANAME = 'SALLY' AND RATION.ASPECIES = 'MONKEY');

SELECT DISTINCT ANIMAL.ANAME, ANIMAL.ASPECIES
FROM ANIMAL, RATION
WHERE RATION.ANAME = ANIMAL.ANAME AND RATION.ASPECIES = ANIMAL.ASPECIES AND ANIMAL.CLOC IN (SELECT DISTINCT ANIMAL.CLOC
FROM RATION, ANIMAL
WHERE RATION.ANAME = ANIMAL.ANAME AND RATION.ASPECIES = ANIMAL.ASPECIES AND RATION.FDESC IN (SELECT RATION.FDESC FROM RATION WHERE RATION.ANAME = 'SALLY' AND RATION.ASPECIES = 'MONKEY'));
